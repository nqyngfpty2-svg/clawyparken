{% extends "base.html" %}
{% block content %}
<h2 class="h5">Owner: <span class="mono">{{ spot }}</span> – Buchungen</h2>

<div class="d-flex justify-content-between align-items-center mb-2">
  <a class="btn btn-outline-secondary btn-sm" href="/owner/portal?code={{ code }}&p={{ portal_p or 0 }}">← Zurück zum Owner-Portal</a>
  <div class="d-flex gap-2">
    {% if has_prev %}
      <a class="btn btn-sm btn-outline-secondary" href="/owner/bookings?code={{ code }}&p={{ p-1 }}&portal_p={{ portal_p or 0 }}">← Neuer</a>
    {% endif %}
    {% if has_next %}
      <a class="btn btn-sm btn-outline-secondary" href="/owner/bookings?code={{ code }}&p={{ p+1 }}&portal_p={{ portal_p or 0 }}">Älter →</a>
    {% endif %}
  </div>
</div>

<div class="alert alert-info">
  Es werden keine personenbezogenen Daten gespeichert. Diese Übersicht zeigt Datum und Status der Buchungen für diesen Parkplatz.
</div>

<div class="table-responsive">
  <table class="table table-sm align-middle">
    <thead>
      <tr>
        <th>Tag</th>
        <th>Status</th>
        <th>Erstellt</th>
        <th>Storno</th>
        <th>Grund</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      {% for r in rows %}
      <tr>
        <td class="mono">{{ r.day }}</td>
        <td>
          {% if r.status == 'active' %}
            <span class="badge text-bg-warning">aktiv</span>
          {% elif r.status == 'cancelled_by_owner' %}
            <span class="badge text-bg-secondary">storniert (owner)</span>
          {% elif r.status == 'cancelled_by_booker' %}
            <span class="badge text-bg-secondary">storniert (buchung)</span>
          {% else %}
            <span class="badge text-bg-secondary">{{ r.status }}</span>
          {% endif %}
        </td>
        <td class="mono small">{{ r.created_at or '—' }}</td>
        <td class="mono small">{{ r.cancelled_at or '—' }}</td>
        <td class="small">{{ r.cancel_reason or '—' }}</td>
        <td>
          <a class="btn btn-sm btn-outline-primary" href="/day/{{ r.day }}">Tag öffnen</a>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

{% if rows|length == 0 %}
  <div class="text-muted">Keine Buchungen vorhanden.</div>
{% endif %}

{% endblock %}
